<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:vm="clr-namespace:SmartShop.MAUI.ViewModels"
             x:Class="SmartShop.MAUI.Views.LoginPage" 
             BackgroundColor="Transparent"
             NavigationPage.HasNavigationBar="False"
             Shell.NavBarIsVisible="False"
             Shell.FlyoutBehavior="Disabled"
             x:DataType="vm:LoginViewModel">

    <ContentPage.Background>
    <StaticResource Key="LoginPageBackgroundBrush" />
    </ContentPage.Background>

    <Grid>
        <!-- Main Content -->
        <ScrollView Grid.Row="0">
            <StackLayout Padding="30" Spacing="20" VerticalOptions="Center">

                <Label Text="Welcome" 
                       FontSize="24" 
                       HorizontalOptions="Center"
                       TextColor="#FFFFFF" />

                <Entry Placeholder="Username"
                       Text="{Binding Username}"
                       BackgroundColor="#004e92" 
                       TextColor="#FFFFFF" />

                <Entry Placeholder="Password"
                       Text="{Binding Password}"
                       IsPassword="True"
                       BackgroundColor="#004e92"  
                       TextColor="#FFFFFF" />

                <Label Text="{Binding AlertMessage}" 
                       TextColor="#FFD700" 
                       IsVisible="{Binding AlertMessage, Converter={StaticResource StringNotEmptyConverter}}" 
                       HorizontalTextAlignment="Center"/>

                <Button Text="Login"
                        Command="{Binding LoginCommand}"
                        Style="{StaticResource LoginButtonStyle}"
                        IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBooleanConverter}}" />

                <Button Text="Forgot Password"
                        Command="{Binding ForgotPasswordCommand}"
                        BackgroundColor="Transparent"
                        TextColor="#FFFFFF"  
                        FontAttributes="Italic" />

                <ActivityIndicator 
                    IsRunning="{Binding IsBusy}" 
                    IsVisible="{Binding IsBusy}"
                    Color="#FFFFFF" />
            </StackLayout>
        </ScrollView>

        <!-- App Version and Server Status -->
        <StackLayout Orientation="Horizontal" HorizontalOptions="Center" VerticalOptions="End" Grid.Row="1" Spacing="10">
            <Label Text="{Binding AppVersion}"
                   FontSize="12"
                   TextColor="#FFFFFF" />
            <Label Text="|"
                   FontSize="12"
                   TextColor="#FFFFFF" />
            <Label Text="{Binding ServerStatus}"
                   FontSize="12"
                   TextColor="{Binding ServerStatus, Converter={StaticResource ServerStatusColorConverter}}" />
        </StackLayout>
    </Grid>
</ContentPage>